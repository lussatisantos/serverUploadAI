{"version":3,"file":"toad-cache.umd.min.js","sources":["../src/FifoMap.js","../src/LruObject.js","../src/HitStatisticsRecord.js","../src/utils/dateUtils.js","../src/HitStatistics.js","../src/LruObjectHitStatistics.js","../src/FifoObject.js","../src/LruMap.js"],"sourcesContent":["export class FifoMap {\n  constructor(max = 1000, ttlInMsecs = 0) {\n    if (isNaN(max) || max < 0) {\n      throw new Error('Invalid max value')\n    }\n\n    if (isNaN(ttlInMsecs) || ttlInMsecs < 0) {\n      throw new Error('Invalid ttl value')\n    }\n\n    this.first = null\n    this.items = new Map()\n    this.last = null\n    this.max = max\n    this.ttl = ttlInMsecs\n  }\n\n  get size() {\n    return this.items.size\n  }\n\n  clear() {\n    this.items = new Map()\n    this.first = null\n    this.last = null\n  }\n\n  delete(key) {\n    if (this.items.has(key)) {\n      const deletedItem = this.items.get(key)\n\n      this.items.delete(key)\n\n      if (deletedItem.prev !== null) {\n        deletedItem.prev.next = deletedItem.next\n      }\n\n      if (deletedItem.next !== null) {\n        deletedItem.next.prev = deletedItem.prev\n      }\n\n      if (this.first === deletedItem) {\n        this.first = deletedItem.next\n      }\n\n      if (this.last === deletedItem) {\n        this.last = deletedItem.prev\n      }\n    }\n  }\n\n  evict() {\n    if (this.size > 0) {\n      const item = this.first\n\n      this.items.delete(item.key)\n\n      if (this.size === 0) {\n        this.first = null\n        this.last = null\n      } else {\n        this.first = item.next\n        this.first.prev = null\n      }\n    }\n  }\n\n  expiresAt(key) {\n    if (this.items.has(key)) {\n      return this.items.get(key).expiry\n    }\n  }\n\n  get(key) {\n    if (this.items.has(key)) {\n      const item = this.items.get(key)\n\n      if (this.ttl > 0 && item.expiry <= Date.now()) {\n        this.delete(key)\n        return\n      }\n\n      return item.value\n    }\n  }\n\n  keys() {\n    return this.items.keys()\n  }\n\n  set(key, value) {\n    // Replace existing item\n    if (this.items.has(key)) {\n      const item = this.items.get(key)\n      item.value = value\n\n      item.expiry = this.ttl > 0 ? Date.now() + this.ttl : this.ttl\n\n      return\n    }\n\n    // Add new item\n    if (this.max > 0 && this.size === this.max) {\n      this.evict()\n    }\n\n    const item = {\n      expiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n      key: key,\n      prev: this.last,\n      next: null,\n      value,\n    }\n    this.items.set(key, item)\n\n    if (this.size === 1) {\n      this.first = item\n    } else {\n      this.last.next = item\n    }\n\n    this.last = item\n  }\n}\n","export class LruObject {\n  constructor(max = 1000, ttlInMsecs = 0) {\n    if (isNaN(max) || max < 0) {\n      throw new Error('Invalid max value')\n    }\n\n    if (isNaN(ttlInMsecs) || ttlInMsecs < 0) {\n      throw new Error('Invalid ttl value')\n    }\n\n    this.first = null\n    this.items = Object.create(null)\n    this.last = null\n    this.size = 0\n    this.max = max\n    this.ttl = ttlInMsecs\n  }\n\n  bumpLru(item) {\n    const last = this.last\n    const next = item.next\n    const prev = item.prev\n\n    if (this.first === item) {\n      this.first = item.next\n    }\n\n    item.next = null\n    item.prev = this.last\n    last.next = item\n\n    if (prev !== null) {\n      prev.next = next\n    }\n\n    if (next !== null) {\n      next.prev = prev\n    }\n\n    this.last = item\n  }\n\n  clear() {\n    this.items = Object.create(null)\n    this.first = null\n    this.last = null\n    this.size = 0\n  }\n\n  delete(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key]\n\n      delete this.items[key]\n      this.size--\n\n      if (item.prev !== null) {\n        item.prev.next = item.next\n      }\n\n      if (item.next !== null) {\n        item.next.prev = item.prev\n      }\n\n      if (this.first === item) {\n        this.first = item.next\n      }\n\n      if (this.last === item) {\n        this.last = item.prev\n      }\n    }\n  }\n\n  evict() {\n    if (this.size > 0) {\n      const item = this.first\n\n      delete this.items[item.key]\n\n      if (--this.size === 0) {\n        this.first = null\n        this.last = null\n      } else {\n        this.first = item.next\n        this.first.prev = null\n      }\n    }\n  }\n\n  expiresAt(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      return this.items[key].expiry\n    }\n  }\n\n  get(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key]\n\n      // Item has already expired\n      if (this.ttl > 0 && item.expiry <= Date.now()) {\n        this.delete(key)\n        return\n      }\n\n      // Item is still fresh\n      this.bumpLru(item)\n      return item.value\n    }\n  }\n\n  keys() {\n    return Object.keys(this.items)\n  }\n\n  set(key, value) {\n    // Replace existing item\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key]\n      item.value = value\n\n      item.expiry = this.ttl > 0 ? Date.now() + this.ttl : this.ttl\n\n      if (this.last !== item) {\n        this.bumpLru(item)\n      }\n      return\n    }\n\n    // Add new item\n    if (this.max > 0 && this.size === this.max) {\n      this.evict()\n    }\n\n    const item = {\n      expiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n      key: key,\n      prev: this.last,\n      next: null,\n      value,\n    }\n    this.items[key] = item\n\n    if (++this.size === 1) {\n      this.first = item\n    } else {\n      this.last.next = item\n    }\n\n    this.last = item\n  }\n}\n","export class HitStatisticsRecord {\n  constructor() {\n    this.records = {}\n  }\n\n  initForCache(cacheId, currentTimeStamp) {\n    this.records[cacheId] = {\n      [currentTimeStamp]: {\n        hits: 0,\n        misses: 0,\n        expirations: 0,\n      },\n    }\n  }\n\n  resetForCache(cacheId) {\n    for (let key of Object.keys(this.records[cacheId])) {\n      this.records[cacheId][key] = {\n        hits: 0,\n        misses: 0,\n        expirations: 0,\n      }\n    }\n  }\n\n  getStatistics() {\n    return this.records\n  }\n}\n","/**\n *\n * @param {Date} date\n * @returns {string}\n */\nexport function getTimestamp(date) {\n  return `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-${date\n    .getDate()\n    .toString()\n    .padStart(2, '0')}`\n}\n","import { HitStatisticsRecord } from './HitStatisticsRecord.js'\nimport { getTimestamp } from './utils/dateUtils.js'\n\nexport class HitStatistics {\n  constructor(cacheId, statisticTtlInHours, globalStatisticsRecord) {\n    this.collectionStart = new Date()\n\n    this.lastTimeStamp = ''\n    this.currentTimeStamp = getTimestamp(this.collectionStart)\n    this.cacheId = cacheId\n    this.statisticTtlInHours = statisticTtlInHours\n\n    this.records = globalStatisticsRecord || new HitStatisticsRecord()\n    this.records.initForCache(this.cacheId, this.currentTimeStamp)\n  }\n\n  hoursPassed() {\n    return (Date.now() - this.collectionStart) / 1000 / 60 / 60\n  }\n\n  addHit() {\n    this.archiveIfNeeded()\n    this.records.records[this.cacheId][this.currentTimeStamp].hits++\n  }\n\n  addMiss() {\n    this.archiveIfNeeded()\n    this.records.records[this.cacheId][this.currentTimeStamp].misses++\n  }\n\n  addExpiration() {\n    this.archiveIfNeeded()\n    this.records.records[this.cacheId][this.currentTimeStamp].expirations++\n  }\n\n  getStatistics() {\n    return this.records.getStatistics()\n  }\n\n  archiveIfNeeded() {\n    if (this.hoursPassed() >= this.statisticTtlInHours) {\n      const now = new Date()\n      const newTimestamp = getTimestamp(now)\n\n      if (this.lastTimeStamp && this.lastTimeStamp !== newTimestamp) {\n        delete this.records.records[this.cacheId][this.lastTimeStamp]\n      }\n      this.lastTimeStamp = this.currentTimeStamp\n\n      this.collectionStart = now\n      this.currentTimeStamp = getTimestamp(this.collectionStart)\n      this.records.initForCache(this.cacheId, this.currentTimeStamp)\n    }\n  }\n}\n","import { LruObject } from './LruObject.js'\nimport { HitStatistics } from './HitStatistics.js'\n\nexport class LruObjectHitStatistics extends LruObject {\n  constructor(max, ttlInMsecs, cacheId, globalStatisticsRecord, statisticTtlInHours) {\n    super(max || 1000, ttlInMsecs || 0)\n\n    if (!cacheId) {\n      throw new Error('Cache id is mandatory')\n    }\n\n    this.hitStatistics = new HitStatistics(\n      cacheId,\n      statisticTtlInHours !== undefined ? statisticTtlInHours : 24,\n      globalStatisticsRecord\n    )\n  }\n\n  getStatistics() {\n    return this.hitStatistics.getStatistics()\n  }\n\n  get(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key]\n\n      // Item has already expired\n      if (this.ttl > 0 && item.expiry <= Date.now()) {\n        this.delete(key)\n        this.hitStatistics.addExpiration()\n        return\n      }\n\n      // Item is still fresh\n      this.bumpLru(item)\n      this.hitStatistics.addHit()\n      return item.value\n    }\n    this.hitStatistics.addMiss()\n  }\n}\n","export class FifoObject {\n  constructor(max = 1000, ttlInMsecs = 0) {\n    if (isNaN(max) || max < 0) {\n      throw new Error('Invalid max value')\n    }\n\n    if (isNaN(ttlInMsecs) || ttlInMsecs < 0) {\n      throw new Error('Invalid ttl value')\n    }\n\n    this.first = null\n    this.items = Object.create(null)\n    this.last = null\n    this.size = 0\n    this.max = max\n    this.ttl = ttlInMsecs\n  }\n\n  clear() {\n    this.items = Object.create(null)\n    this.first = null\n    this.last = null\n    this.size = 0\n  }\n\n  delete(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const deletedItem = this.items[key]\n\n      delete this.items[key]\n      this.size--\n\n      if (deletedItem.prev !== null) {\n        deletedItem.prev.next = deletedItem.next\n      }\n\n      if (deletedItem.next !== null) {\n        deletedItem.next.prev = deletedItem.prev\n      }\n\n      if (this.first === deletedItem) {\n        this.first = deletedItem.next\n      }\n\n      if (this.last === deletedItem) {\n        this.last = deletedItem.prev\n      }\n    }\n  }\n\n  evict() {\n    if (this.size > 0) {\n      const item = this.first\n\n      delete this.items[item.key]\n\n      if (--this.size === 0) {\n        this.first = null\n        this.last = null\n      } else {\n        this.first = item.next\n        this.first.prev = null\n      }\n    }\n  }\n\n  expiresAt(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      return this.items[key].expiry\n    }\n  }\n\n  get(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key]\n\n      if (this.ttl > 0 && item.expiry <= Date.now()) {\n        this.delete(key)\n        return\n      }\n\n      return item.value\n    }\n  }\n\n  keys() {\n    return Object.keys(this.items)\n  }\n\n  set(key, value) {\n    // Replace existing item\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key]\n      item.value = value\n\n      item.expiry = this.ttl > 0 ? Date.now() + this.ttl : this.ttl\n\n      return\n    }\n\n    // Add new item\n    if (this.max > 0 && this.size === this.max) {\n      this.evict()\n    }\n\n    const item = {\n      expiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n      key: key,\n      prev: this.last,\n      next: null,\n      value,\n    }\n    this.items[key] = item\n\n    if (++this.size === 1) {\n      this.first = item\n    } else {\n      this.last.next = item\n    }\n\n    this.last = item\n  }\n}\n","export class LruMap {\n  constructor(max = 1000, ttlInMsecs = 0) {\n    if (isNaN(max) || max < 0) {\n      throw new Error('Invalid max value')\n    }\n\n    if (isNaN(ttlInMsecs) || ttlInMsecs < 0) {\n      throw new Error('Invalid ttl value')\n    }\n\n    this.first = null\n    this.items = new Map()\n    this.last = null\n    this.max = max\n    this.ttl = ttlInMsecs\n  }\n\n  get size() {\n    return this.items.size\n  }\n\n  bumpLru(item) {\n    const last = this.last\n    const next = item.next\n    const prev = item.prev\n\n    if (this.first === item) {\n      this.first = item.next\n    }\n\n    item.next = null\n    item.prev = this.last\n    last.next = item\n\n    if (prev !== null) {\n      prev.next = next\n    }\n\n    if (next !== null) {\n      next.prev = prev\n    }\n\n    this.last = item\n  }\n\n  clear() {\n    this.items = new Map()\n    this.first = null\n    this.last = null\n  }\n\n  delete(key) {\n    if (this.items.has(key)) {\n      const item = this.items.get(key)\n\n      this.items.delete(key)\n\n      if (item.prev !== null) {\n        item.prev.next = item.next\n      }\n\n      if (item.next !== null) {\n        item.next.prev = item.prev\n      }\n\n      if (this.first === item) {\n        this.first = item.next\n      }\n\n      if (this.last === item) {\n        this.last = item.prev\n      }\n    }\n  }\n\n  evict() {\n    if (this.size > 0) {\n      const item = this.first\n\n      this.items.delete(item.key)\n\n      if (this.size === 0) {\n        this.first = null\n        this.last = null\n      } else {\n        this.first = item.next\n        this.first.prev = null\n      }\n    }\n  }\n\n  expiresAt(key) {\n    if (this.items.has(key)) {\n      return this.items.get(key).expiry\n    }\n  }\n\n  get(key) {\n    if (this.items.has(key)) {\n      const item = this.items.get(key)\n\n      // Item has already expired\n      if (this.ttl > 0 && item.expiry <= Date.now()) {\n        this.delete(key)\n        return\n      }\n\n      // Item is still fresh\n      this.bumpLru(item)\n      return item.value\n    }\n  }\n\n  keys() {\n    return this.items.keys()\n  }\n\n  set(key, value) {\n    // Replace existing item\n    if (this.items.has(key)) {\n      const item = this.items.get(key)\n      item.value = value\n\n      item.expiry = this.ttl > 0 ? Date.now() + this.ttl : this.ttl\n\n      if (this.last !== item) {\n        this.bumpLru(item)\n      }\n      return\n    }\n\n    // Add new item\n    if (this.max > 0 && this.size === this.max) {\n      this.evict()\n    }\n\n    const item = {\n      expiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n      key: key,\n      prev: this.last,\n      next: null,\n      value,\n    }\n    this.items.set(key, item)\n\n    if (this.size === 1) {\n      this.first = item\n    } else {\n      this.last.next = item\n    }\n\n    this.last = item\n  }\n}\n"],"names":["g","f","exports","module","define","amd","globalThis","self","this","LruObject","constructor","max","ttlInMsecs","isNaN","Error","first","items","Object","create","last","size","ttl","bumpLru","item","next","prev","clear","delete","key","prototype","hasOwnProperty","call","evict","expiresAt","expiry","get","Date","now","value","keys","set","HitStatisticsRecord","records","initForCache","cacheId","currentTimeStamp","hits","misses","expirations","resetForCache","getStatistics","getTimestamp","date","getFullYear","getMonth","toString","padStart","getDate","HitStatistics","statisticTtlInHours","globalStatisticsRecord","collectionStart","lastTimeStamp","hoursPassed","addHit","archiveIfNeeded","addMiss","addExpiration","newTimestamp","LruObjectHitStatistics","super","hitStatistics","undefined","FifoObject","deletedItem","Fifo","FifoMap","Map","has","Lru","LruHitStatistics","LruMap"],"mappings":"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"}